## You Look Good In Print

### Бизнес-контекст
Сеть копировальных магазинов хочет расширить свои услуги, предоставив клиентам онлайн-платформу для создания, редактирования, хранения и печати документов.
Реализация должна:
- повысить лояльность клиентов,
- сократить зависимость от внешних подрядчиков (операционные сервисы сейчас обрабатываются другой, не очень отзывчивой компанией),
- увеличить продажи (платное хранение, платная печать, премиум-функции).

### Бизнес-цели и бизнес-драйверы
Цели:
- Создать удобный сервис «всё-в-одном» (онлайн-офис + печать).
- Удерживать и расширять клиентскую базу (лояльность, постоянные пользователи).
- Повысить операционную независимость (меньше зависеть от внешних подрядчиков).
- Разработать масштабируемое решение (от тысяч до миллионов пользователей).
  Драйверы:
- Конкуренция (онлайн-редакторы от Google, Microsoft, но без интеграции с локальной печатью).
- Поведение клиентов (удобство: не надо приносить флешку или файл, можно готовить документ онлайн и печатать в магазине).
- Монетизация (оплата печати, платное хранилище, подписки на премиум-шаблоны).
- Рост спроса (если продукт окажется успешным, масштаб до миллионов пользователей).
- Снизим время на обработку клиентского запроса в 5 раз

### Стейкхолдеры и их потребности
Клиенты (конечные пользователи)
- Удобное создание и хранение документов
- Доступ из браузера без установки ПО
- Гарантия сохранности и версионности
- Простая печать (онлайн-заказ + выбор времени)
- Прозрачные и удобные способы оплаты
  3.2 Менеджмент сети магазинов
- Рост дохода от печатных и облачных услуг
- Повышение лояльности клиентов
- Уменьшение зависимости от сторонней компании

Сотрудники магазинов
- Простая интеграция заказов печати в рабочие процессы
- Минимум ручного ввода

IT команда
- Масштабируемая архитектура
- Управляемость (логирование, мониторинг)
- Интеграция с платёжными шлюзами и системами печати

### Пользовательские истории (Use cases)
Создание документа
- Как пользователь, я хочу создать новый документ в браузере, используя шаблон, чтобы быстро подготовить файл.

Редактирование и хранение
- Как пользователь, я хочу редактировать свои документы онлайн и хранить их в облаке, чтобы получить доступ с любого устройства.

Версионирование
- Как пользователь, я хочу видеть историю изменений и откатывать версии документа, чтобы не потерять важные данные.

Заказ печати
- Как пользователь, я хочу отправить документ на печать в ближайший магазин, выбрав время, чтобы получить его без ожидания.

Оплата
- Как пользователь, я хочу оплачивать печать и хранение картой или наличными, чтобы это было удобно.

Уведомления
- Как пользователь, я хочу получать уведомления о готовности заказа, чтобы вовремя забрать документы.

### Атрибуты качества (нефункциональные требования)
- Масштабируемость — от тысяч до миллионов пользователей.
- Доступность — 99.9% uptime, минимальные простои.
- Безопасность — шифрование хранения и передачи данных, защита персональных данных.
- Юзабилити — простота интерфейса (сравнимо с Google Docs).
- Интегрируемость — API для платёжных шлюзов и системы печати.
- Отзывчивость — документы открываются и редактируются без задержек.
- Надёжность — не должно быть потери данных, поддержка версий.

### Контекстная схема системы
- Выполняем команду 
```bash
    docker-compose up structurizr-lite -d 
```
- Переходим на URL http://localhost:8080/
- Получаем контекстную диаграмму
![structurizr-1-SystemContext-001(1).png](architecture/diagrams/structurizr-1-SystemContext-001%281%29.png)

### Критические сценарии и характеристики
- Критический сценарий 1: Массовая печать документов (перед экзаменами, событиями)
- Характеристика: система должна выдерживать пиковые нагрузки
- Критический сценарий 2: Пользователь сохраняет важный документ
- Характеристика: высокая надёжность и версионирование.
- Критический сценарий 3: Пользователь оплачивает услугу
- Характеристика: безопасность и интеграция с платёжными системами.
- Критический сценарий 4: Рост пользователей с 10 тыс. до 1 млн
- Характеристика: масштабируемость и гибкость архитектуры (кластеризация, облачные ресурсы).

### ADR
- Для просмотра списка требуется выполнить требования ADR - 
[0002-use-adr-toolsadr.md](architecture/decisions/0002-use-adr-toolsadr.md)
- После выполенния команды:
  ```bash
  adr generate toc
  ```
  получаем список 
```text
* [1. Record architecture decisions](0001-record-architecture-decisions.md)
* [3. Использование adr-tools для ведения журнала решений](0002-use-adr-toolsadr.md)
* [2. Выбор Structurizr DSL для описания архитектуры](0003-use-stcructurizr-dsl.md)
* [4. Использование Structurizr CLI для генерации диаграмм из DSL](0004-use-structurizr-cli.md)
* [5. Выбор браузерного веб-приложения как основного интерфейса](0005-browser-web-application-as-the-main-interface.md)
* [6. Облачное хранение документов и версионирование](0006-cloud-document-storage-and-versioning.md)
* [7. Интеграция с внешним платёжным шлюзом](0007-integration-with-an-external-payment-gateway.md)

```
### Таблица критических сценариев

| № | Сценарий                            | Стимул (Trigger)                                                             | Ожидаемая реакция системы                                                          | Метрики / SLA                                                                                                                                                          |
| - | ----------------------------------- | ---------------------------------------------------------------------------- | ---------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1 | Массовая печать документов          | 10 000 пользователей одновременно загружают и отправляют документы на печать | Система принимает, обрабатывает и ставит документы в очередь на печать без отказов | - До **500 req/sec** без деградации<br>- Время отклика API ≤ **2 сек** (95-й перцентиль)<br>- Доступность: **99.9% uptime/мес**                                        |
| 2 | Сохранение важного документа        | Пользователь нажимает «Сохранить» при редактировании                         | Документ сохраняется и появляется новая версия в истории                           | - Время сохранения ≤ **1 сек**<br>- Версия доступна ≤ **3 сек**<br>- Потеря данных ≤ **0.1%**<br>- RPO ≤ **1 мин**, RTO ≤ **5 мин**                                    |
| 3 | Оплата услуги                       | Пользователь оплачивает печать/хранение (онлайн или в магазине)              | Система подтверждает оплату и фиксирует транзакцию                                 | - Авторизация платежа ≤ **5 сек** (95-й перцентиль)<br>- Дублирование транзакций ≤ **0.01%**<br>- Уведомление об оплате ≤ **10 сек**                                   |
| 4 | Заказ печати и получение в магазине | Пользователь отправляет документ на печать после оплаты                      | Документ попадает в локальную систему печати, пользователь уведомлён о готовности  | - Доставка в очередь печати ≤ **15 сек**<br>- SLA доставки: **99.5% ≤ 1 мин**<br>- Уведомление о готовности ≤ **30 сек**                                               |
| 5 | Масштабирование                     | Рост пользователей с 10 000 до 1 000 000                                     | Система обслуживает новых пользователей без деградации                             | - Рост нагрузки ×10 увеличивает отклик не более чем на **20%**<br>- Горизонтальное масштабирование ≤ **30 мин**<br>- SLA: **1 млн пользователей/мес при 99.9% uptime** |
| 6 | Уведомления пользователям           | Завершена печать или проведена оплата                                        | Пользователь получает e-mail / push / SMS                                          | - Время доставки ≤ **30 сек** (95-й перцентиль)<br>- SLA: ≥ **99% доставленных уведомлений**                                                                           |
